### 验证

这一步的目的是确保`Class`文件的字节流中包含的信息符合《Java虚拟机规范》的全部要求，

保证这些信息被当作代码运行后不会危害虚拟机自身的安全。

验证阶段在虚拟机的类加载过程中占了相当大的比重。

验证阶段大致上会完成下边四个阶段的检验动作

1. 文件格式验证
2. 元数据验证
3. 字节码验证
4. 符号引用验证



#### 文件格式验证

验证字节流是否符合`Class`文件格式的规范，并且能被当前虚拟机处理。包括：

* 是否以魔数`0xCAFEBABE`开头
* 主、次版本号是否在当前`Java`虚拟机接受范围之内
* 常量池的常量中是否有不被支持的常量类型（检测常量标识`tag`）
* 指向常量的各种索引值中是否有指向不存在的常量或不符合类型的常量
* `CONSTANT_Utf8_info`型的常量中是否有不符合`UTF-8`编码的数据
* `Class`文件中各个部分及文件本身是否有被删除的或附加的其他信息
* ...

只有通过这个阶段的验证之后，字节流才允许进入`Java`虚拟机内存的方法区中存储，

后边的三个验证阶段全部是基于方法区的存储结构上进行的，不会再直接读、操作字节流了。



#### 元数据验证

对字节码描述的信息进行语义分析，保证其描述的信息符合《Java语言规范》的要求。包括：

* 这个类是否有父类（出了`java.lang.Object`，所有类都应当有父类）
* 这个类的父类是否继承了不允许被继承的类（被`final`修饰的类）
* 如果这个类不是抽象类，是否实现了其父类或接口中要求实现的所有方法